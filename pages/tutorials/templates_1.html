<!DOCTYPE html>

<html :class="{ 'dark' : darkMode === true }" data-content_root="../../" lang="en" x-data="{ darkMode: $persist(window.matchMedia('(prefers-color-scheme: dark)').matches), activeSection: ''}">
<head>
<script>
    (function () {
      // Set initial color scheme
      if ((localStorage.getItem("_x_darkMode") === "true") || (window.matchMedia("(prefers-color-scheme: dark)").matches)) {
        document.documentElement.classList.add("dark");
      }

      // Watch for media preference changes
      window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", (event) => {
        localStorage.setItem("_x_darkMode", event.matches);
        document.documentElement.classList.toggle("dark", event.matches);
      });
    })();
  </script>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta charset="utf-8"/>
<meta content="#ffffff" media="(prefers-color-scheme: light)" name="theme-color"/>
<meta content="#030711" media="(prefers-color-scheme: dark)" name="theme-color"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Templates: Part I | IESopt 2.13.1.dev0 documentation</title>
<meta content="Templates: Part I | IESopt 2.13.1.dev0 documentation" property="og:title"/>
<meta content="Templates: Part I | IESopt 2.13.1.dev0 documentation" name="twitter:title"/>
<link href="../../_static/pygments.css?v=0a3749eb" rel="stylesheet" type="text/css"/>
<link href="../../_static/pygments_dark.css" id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css"/>
<link href="../../_static/theme.css?v=73505e79" rel="stylesheet" type="text/css"/>
<link href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/togglebutton.css?v=9c3e77be" rel="stylesheet" type="text/css"/>
<link href="../../_static/custom.css?v=89055611" rel="stylesheet" type="text/css"/>
<link href="../../_static/awesome-myst-nb.css?v=3b66abd6" rel="stylesheet" type="text/css"/>
<link href="../../_static/favicon.ico" rel="icon"/>
<link href="../../search.html" rel="search" title="Search"/>
<link href="../../genindex.html" rel="index" title="Index"/>
<link href="templates_2.html" rel="next" title="Templates: Part II"/>
<link href="../../tocs/tutorials_templates.html" rel="prev" title="Templates"/>
</head>
<body :class="{ 'overflow-hidden': showSidebar }" @scroll.window="showScrollTop = pageYOffset &gt; 100" class="min-h-screen font-sans antialiased bg-background text-foreground" x-data="{ showSidebar: false, showScrollTop: false }">
<div @click.self="showSidebar = false" class="fixed inset-0 z-50 overflow-hidden bg-background/80 backdrop-blur-sm md:hidden" x-cloak="" x-show="showSidebar"></div><div class="relative flex flex-col min-h-screen" id="page"><a class="absolute top-0 left-0 z-[100] block bg-background p-4 text-xl transition -translate-x-full opacity-0 focus:translate-x-0 focus:opacity-100" href="#content">
      Skip to content
    </a><header class="sticky top-0 z-40 w-full border-b shadow-xs border-border bg-background/90 backdrop-blur"><div class="container flex items-center h-14">
<div class="hidden mr-4 md:flex">
<a class="flex items-center mr-6" href="../../index.html"><span class="hidden font-bold sm:inline-block text-clip whitespace-nowrap">IESopt 2.13.1.dev0 documentation</span>
</a><nav class="flex items-center gap-6 text-sm font-medium">
<a class="transition-colors hover:text-foreground/80 text-foreground/60" href="../../index.html">Home</a>
<a class="transition-colors hover:text-foreground/80 text-foreground/60" href="https://github.com/ait-energy/iesopt" rel="noopener nofollow">GitHub</a>
<a class="transition-colors hover:text-foreground/80 text-foreground/60" href="https://github.com/ait-energy/IESopt.jl" rel="noopener nofollow">IESopt.jl</a>
</nav></div><button @click="showSidebar = true" class="inline-flex items-center justify-center h-10 px-0 py-2 mr-2 text-base font-medium transition-colors rounded-md hover:text-accent-foreground hover:bg-transparent md:hidden" type="button">
<svg aria-hidden="true" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M152.587 825.087q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440Zm0-203.587q-19.152 0-32.326-13.174T107.087 576q0-19.152 13.174-32.326t32.326-13.174h320q19.152 0 32.326 13.174T518.087 576q0 19.152-13.174 32.326T472.587 621.5h-320Zm0-203.587q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440ZM708.913 576l112.174 112.174q12.674 12.674 12.674 31.826t-12.674 31.826Q808.413 764.5 789.261 764.5t-31.826-12.674l-144-144Q600 594.391 600 576t13.435-31.826l144-144q12.674-12.674 31.826-12.674t31.826 12.674q12.674 12.674 12.674 31.826t-12.674 31.826L708.913 576Z"></path>
</svg>
<span class="sr-only">Toggle navigation menu</span>
</button>
<div class="flex items-center justify-between flex-1 gap-2 sm:gap-4 md:justify-end">
<div class="flex-1 w-full md:w-auto md:flex-none"><form @keydown.k.window.meta="$refs.search.focus()" action="../../search.html" class="relative flex items-center group" id="searchbox" method="get">
<input aria-label="Search the docs" class="inline-flex items-center font-medium transition-colors bg-transparent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background border border-input hover:bg-accent focus:bg-accent hover:text-accent-foreground focus:text-accent-foreground hover:placeholder-accent-foreground py-2 px-4 relative h-9 w-full justify-start rounded-[0.5rem] text-sm text-muted-foreground sm:pr-12 md:w-40 lg:w-64" id="search-input" name="q" placeholder="Search ..." type="search" x-ref="search"/>
<kbd class="pointer-events-none absolute right-1.5 top-2 hidden h-5 select-none text-muted-foreground items-center gap-1 rounded border border-border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex group-hover:bg-accent group-hover:text-accent-foreground">
<span class="text-xs">⌘</span>
    K
  </kbd>
</form>
</div>
<nav class="flex items-center gap-1">
<button @click="darkMode = !darkMode" class="relative inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md hover:bg-accent hover:text-accent-foreground h-9 w-9" title="Toggle color scheme" type="button">
<svg class="absolute transition-all scale-100 rotate-0 dark:-rotate-90 dark:scale-0" fill="currentColor" height="16" viewbox="0 96 960 960" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M480 685q45.456 0 77.228-31.772Q589 621.456 589 576q0-45.456-31.772-77.228Q525.456 467 480 467q-45.456 0-77.228 31.772Q371 530.544 371 576q0 45.456 31.772 77.228Q434.544 685 480 685Zm0 91q-83 0-141.5-58.5T280 576q0-83 58.5-141.5T480 376q83 0 141.5 58.5T680 576q0 83-58.5 141.5T480 776ZM80 621.5q-19.152 0-32.326-13.174T34.5 576q0-19.152 13.174-32.326T80 530.5h80q19.152 0 32.326 13.174T205.5 576q0 19.152-13.174 32.326T160 621.5H80Zm720 0q-19.152 0-32.326-13.174T754.5 576q0-19.152 13.174-32.326T800 530.5h80q19.152 0 32.326 13.174T925.5 576q0 19.152-13.174 32.326T880 621.5h-80Zm-320-320q-19.152 0-32.326-13.174T434.5 256v-80q0-19.152 13.174-32.326T480 130.5q19.152 0 32.326 13.174T525.5 176v80q0 19.152-13.174 32.326T480 301.5Zm0 720q-19.152 0-32.326-13.17Q434.5 995.152 434.5 976v-80q0-19.152 13.174-32.326T480 850.5q19.152 0 32.326 13.174T525.5 896v80q0 19.152-13.174 32.33-13.174 13.17-32.326 13.17ZM222.174 382.065l-43-42Q165.5 327.391 166 308.239t13.174-33.065q13.435-13.674 32.587-13.674t32.065 13.674l42.239 43q12.674 13.435 12.555 31.706-.12 18.272-12.555 31.946-12.674 13.674-31.445 13.413-18.772-.261-32.446-13.174Zm494 494.761-42.239-43q-12.674-13.435-12.674-32.087t12.674-31.565Q686.609 756.5 705.38 757q18.772.5 32.446 13.174l43 41.761Q794.5 824.609 794 843.761t-13.174 33.065Q767.391 890.5 748.239 890.5t-32.065-13.674Zm-42-494.761Q660.5 369.391 661 350.62q.5-18.772 13.174-32.446l41.761-43Q728.609 261.5 747.761 262t33.065 13.174q13.674 13.435 13.674 32.587t-13.674 32.065l-43 42.239q-13.435 12.674-31.706 12.555-18.272-.12-31.946-12.555Zm-495 494.761Q165.5 863.391 165.5 844.239t13.674-32.065l43-42.239q13.435-12.674 32.087-12.674t31.565 12.674Q299.5 782.609 299 801.38q-.5 18.772-13.174 32.446l-41.761 43Q231.391 890.5 212.239 890t-33.065-13.174ZM480 576Z"></path>
</svg>
<svg class="absolute transition-all scale-0 rotate-90 dark:rotate-0 dark:scale-100" fill="currentColor" height="16" viewbox="0 96 960 960" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M480 936q-151 0-255.5-104.5T120 576q0-138 90-239.5T440 218q25-3 39 18t-1 44q-17 26-25.5 55t-8.5 61q0 90 63 153t153 63q31 0 61.5-9t54.5-25q21-14 43-1.5t19 39.5q-14 138-117.5 229T480 936Zm0-80q88 0 158-48.5T740 681q-20 5-40 8t-40 3q-123 0-209.5-86.5T364 396q0-20 3-40t8-40q-78 32-126.5 102T200 576q0 116 82 198t198 82Zm-10-270Z"></path>
</svg>
</button>
</nav>
</div>
</div>
</header>
<div class="flex-1"><div class="container md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[240px_minmax(0,1fr)] lg:gap-10"><aside :aria-hidden="!showSidebar" :class="{ 'translate-x-0': showSidebar }" class="fixed inset-y-0 left-0 md:top-14 z-50 md:z-30 bg-background md:bg-transparent transition-all duration-100 -translate-x-full md:translate-x-0 ml-0 p-6 md:p-0 md:-ml-2 md:h-[calc(100vh-3.5rem)] w-5/6 md:w-full overflow-y-auto border-r border-border md:sticky" id="left-sidebar">
<a class="justify-start text-sm md:!hidden bg-background" href="../../index.html"><span class="font-bold text-clip whitespace-nowrap">IESopt 2.13.1.dev0 documentation</span>
</a>
<div class="relative overflow-hidden md:overflow-auto my-4 md:my-0">
<div class="overflow-y-auto h-full w-full relative pr-6"><nav class="flex md:hidden flex-col font-medium mt-4">
<a href="../../index.html">Home</a>
<a href="https://github.com/ait-energy/iesopt" rel="nofollow noopener">GitHub</a>
<a href="https://github.com/ait-energy/IESopt.jl" rel="nofollow noopener">IESopt.jl</a>
</nav><nav class="table w-full min-w-full my-6 lg:my-8">
<p class="caption" role="heading"><span class="caption-text">IESopt</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/first_model.html">A first model</a></li>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../../tocs/tutorials_extracting_results.html">Extracting results<button @click.prevent.stop="expanded = !expanded" type="button" x-cloak=""><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-cloak="" x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/custom_results_1.html">Part I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/custom_results_2.html">Part II</a></li>
</ul>
</li>
<li class="toctree-l1 current" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../../tocs/tutorials_templates.html">Templates<button @click.prevent.stop="expanded = !expanded" type="button" x-cloak=""><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul class="current" x-show="expanded">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Part I</a></li>
<li class="toctree-l2"><a class="reference internal" href="templates_2.html">Part II</a></li>
<li class="toctree-l2"><a class="reference internal" href="templates/getter_setter.html">Getter and setter functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="addons.html">Addons</a></li>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../../tocs/examples.html">Examples<button @click.prevent.stop="expanded = !expanded" type="button" x-cloak=""><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-cloak="" x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/example_52.html">52</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/example_53.html">53</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/example_54.html">54</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../notebooks/example_55.html">55</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guides/index.html">Intro</a></li>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../user_guides/toc_general.html">General<button @click.prevent.stop="expanded = !expanded" type="button" x-cloak=""><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-cloak="" x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="../user_guides/general/best_practice.html">Best practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guides/general/global_parameters.html">Global parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guides/general/kwargs_config.html">Python: Modify <code class="docutils literal notranslate"><span class="pre">config</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guides/general/monte_carlo.html">Monte Carlo simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guides/general/common_errors.html">Common errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guides/general/linking_components.html">Linking components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guides/general/solvers.html">Solvers</a></li>
</ul>
</li>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../user_guides/toc_qna.html">Q &amp; A<button @click.prevent.stop="expanded = !expanded" type="button" x-cloak=""><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-cloak="" x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="../user_guides/qna/snapshot_duration.html">Time resolution &amp; power vs. energy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guides/qna/profiles_sign.html">Sign convention for time series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guides/qna/dynamic_marginal_costs.html">Output-dependent marginal costs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guides/qna/passive_charging.html">Passive charging of an underground heat storage</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Manual</span></p>
<ul>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../manual/yaml/index.html">YAML<button @click.prevent.stop="expanded = !expanded" type="button" x-cloak=""><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-cloak="" x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="../manual/yaml/top_level.html">Top-level config</a></li>
<li class="toctree-l2" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../manual/yaml/core_components.html">Components<button @click.prevent.stop="expanded = !expanded" type="button" x-cloak=""><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-cloak="" x-show="expanded">
<li class="toctree-l3"><a class="reference internal" href="../manual/yaml/core/connection.html">Connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/yaml/core/decision.html">Decision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/yaml/core/node.html">Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/yaml/core/profile.html">Profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/yaml/core/unit.html">Unit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../manual/python/index.html">Python<button @click.prevent.stop="expanded = !expanded" type="button" x-cloak=""><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-cloak="" x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="../manual/python/configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/python/model.html">Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/python/results.html">Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/python/util.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/python/jump.html">JuMP</a></li>
</ul>
</li>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../manual/julia/index.html">Julia<button @click.prevent.stop="expanded = !expanded" type="button" x-cloak=""><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-cloak="" x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="../manual/julia/assets.html">Assets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/julia/utilities.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/julia/resultsduckdb.html">ResultsDuckDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/julia/resultsjld2.html">ResultsJLD2</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../references/publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/projects.html">Projects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/general.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/core.html">IESopt.jl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/updating.html">Updating</a></li>
</ul>
</nav>
</div>
</div>
<button @click="showSidebar = false" class="absolute md:hidden right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100" type="button">
<svg class="h-4 w-4" fill="currentColor" height="24" stroke="none" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 632 284 828q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536 576l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480 632Z"></path>
</svg>
</button>
</aside>
<main class="relative py-6 lg:gap-10 lg:py-8 xl:grid xl:grid-cols-[1fr_300px]">
<div class="w-full min-w-0 mx-auto">
<nav aria-label="breadcrumbs" class="flex items-center mb-4 space-x-1 text-sm text-muted-foreground">
<a class="overflow-hidden text-ellipsis whitespace-nowrap hover:text-foreground" href="../../index.html">
<span class="hidden md:inline">IESopt 2.13.1.dev0 documentation</span>
<svg aria-label="Home" class="md:hidden" fill="currentColor" height="18" stroke="none" viewbox="0 96 960 960" width="18" xmlns="http://www.w3.org/2000/svg">
<path d="M240 856h120V616h240v240h120V496L480 316 240 496v360Zm-80 80V456l320-240 320 240v480H520V696h-80v240H160Zm320-350Z"></path>
</svg>
</a>
<div class="mr-1">/</div><a class="hover:text-foreground overflow-hidden text-ellipsis whitespace-nowrap" href="../../tocs/tutorials_templates.html">Templates</a>
<div class="mr-1">/</div><span aria-current="page" class="font-medium text-foreground overflow-hidden text-ellipsis whitespace-nowrap">Templates: Part I</span>
</nav>
<div id="content" role="main">
<section class="tex2jax_ignore mathjax_ignore" id="templates-part-i">
<h1>Templates: Part I<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#templates-part-i"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h1>
<p>Templates are a powerful feature of IESopt that allow you to define new types of “components” by yourself. This makes
use of the existing <code class="docutils literal notranslate"><span class="pre">CoreComponent</span></code>s, and combines them in multiple ways, which allows for a high degree of flexibility
without having to write any mathematical model yourself.</p>
<p>This tutorial will guide you through the process of creating a new template, and we will do that on the example of
creating the <code class="docutils literal notranslate"><span class="pre">HeatPump</span></code> template (a template shipped via IESoptLib).</p>
<section id="the-basic-structure">
<h2>The basic structure<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#the-basic-structure" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#the-basic-structure'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>A template is defined by a YAML file, similar to the <code class="docutils literal notranslate"><span class="pre">config.iesopt.yaml</span></code> file that you already know. First, we need to
think about the parameters that we want to define for our heat pump. Let’s create a new file for that. The pre-defined
one in IESoptLib is called <code class="docutils literal notranslate"><span class="pre">HeatPump</span></code>, so we need a different name: Templates must always have a unique name.</p>
<p>Possibilities for that could be:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CustomHeatPump</span></code>, if you do not have any more details</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GroundSourceHeatPump</span></code>, if we want to implement a ground-source heat pump with different parameters/features than the
standard one</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FooHeatPump</span></code>, if you need it specifically for a project called “Foo”</p></li>
</ul>
<div class="note admonition">
<p class="admonition-title">Naming conventions</p>
<p>Templates follow a naming convention similar to <code class="docutils literal notranslate"><span class="pre">PascalCase</span></code>:</p>
<ul class="simple">
<li><p>The name must start with an upper-case letter</p></li>
<li><p>It must consist of at least two letters</p></li>
<li><p>Numbers and special characters are not allowed</p></li>
</ul>
</div>
<p>Let’s go with <code class="docutils literal notranslate"><span class="pre">CustomHeatPump</span></code> for now. Create a new file <code class="docutils literal notranslate"><span class="pre">CustomHeatPump.iesopt.template.yaml</span></code> (if you are already
working on a model, the best place to put this would be a <code class="docutils literal notranslate"><span class="pre">templates/</span></code> folder), and add the following lines:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nt">parameters</span><span class="p">:</span>
</span><span id="line-2"><span class="w">  </span><span class="nt">p_nom</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-3"><span class="w">  </span><span class="nt">electricity_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-4"><span class="w">  </span><span class="nt">heat_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-5"><span class="w">  </span><span class="nt">heat_to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-6"><span class="w">  </span><span class="nt">cop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span></code></pre></div>
</div>
<p>This defines the basic parameters that we want to use for our heat pump. The <code class="docutils literal notranslate"><span class="pre">null</span></code> values indicate that they all
default to <code class="docutils literal notranslate"><span class="pre">nothing</span></code> in Julia, which corresponds to <code class="docutils literal notranslate"><span class="pre">None</span></code> in Python. Let’s go through them:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p_nom</span></code>: The nominal power of the heat pump, which will be specified on the electricity input side</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">electricity_from</span></code>: The <code class="docutils literal notranslate"><span class="pre">Node</span></code> that this heat pump is connected to for electricity input</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">heat_from</span></code>: The <code class="docutils literal notranslate"><span class="pre">Node</span></code> that this heat pump is connected to for heat input</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">heat_to</span></code>: The <code class="docutils literal notranslate"><span class="pre">Node</span></code> that this heat pump is connected to for heat output</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cop</span></code>: The coefficient of performance of the heat pump</p></li>
</ul>
<p>Next, we will set up the actual component. This is done in the <code class="docutils literal notranslate"><span class="pre">component</span></code> section of the template file. Let’s add the
following lines:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nt">component</span><span class="p">:</span>
</span><span id="line-2"><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Unit</span>
</span><span id="line-3"><span class="w">  </span><span class="nt">inputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">electricity</span><span class="p">:</span><span class="w"> </span><span class="nv">&lt;electricity_from&gt;</span><span class="p p-Indicator">,</span><span class="nt"> heat</span><span class="p">:</span><span class="w"> </span><span class="nv">&lt;heat_from&gt;</span><span class="p p-Indicator">}</span>
</span><span id="line-4"><span class="w">  </span><span class="nt">outputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">heat</span><span class="p">:</span><span class="w"> </span><span class="nv">&lt;heat_to&gt;</span><span class="p p-Indicator">}</span>
</span><span id="line-5"><span class="w">  </span><span class="nt">conversion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1 electricity + (&lt;cop&gt; - 1) heat -&gt; &lt;cop&gt; heat</span>
</span><span id="line-6"><span class="w">  </span><span class="nt">capacity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;p_nom&gt; in:electricity</span>
</span></code></pre></div>
</div>
<p>This defines the component that we want to create. The <code class="docutils literal notranslate"><span class="pre">type</span></code> is <code class="docutils literal notranslate"><span class="pre">Unit</span></code>, which is a core component type in IESopt that
you are already familiar with. Instead of providing fixed values, we make use of the parameters that we defined above.
This is done by using the <code class="docutils literal notranslate"><span class="pre">&lt;...&gt;</span></code> syntax.</p>
<p>That’s it! You have created a new template. You can now use this template in your model configuration, as you would with
any other component. For example, you could add the following lines to your <code class="docutils literal notranslate"><span class="pre">config.iesopt.yaml</span></code> file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="c1"># other parts of the configuration file</span>
</span><span id="line-2"><span class="c1"># ...</span>
</span><span id="line-3">
</span><span id="line-4"><span class="nt">components</span><span class="p">:</span>
</span><span id="line-5"><span class="w">  </span><span class="c1"># some other components</span>
</span><span id="line-6"><span class="w">  </span><span class="c1"># ...</span>
</span><span id="line-7">
</span><span id="line-8"><span class="w">  </span><span class="nt">heat_pump</span><span class="p">:</span>
</span><span id="line-9"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CustomHeatPump</span>
</span><span id="line-10"><span class="w">    </span><span class="nt">p_nom</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</span><span id="line-11"><span class="w">    </span><span class="nt">electricity_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">electricity</span>
</span><span id="line-12"><span class="w">    </span><span class="nt">heat_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ambient</span>
</span><span id="line-13"><span class="w">    </span><span class="nt">heat_to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">heating</span>
</span><span id="line-14"><span class="w">    </span><span class="nt">cop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span></code></pre></div>
</div>
</section>
<section id="accounting-for-different-configurations">
<h2>Accounting for different configurations<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#accounting-for-different-configurations" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#accounting-for-different-configurations'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>But wait. What if you want to have different configurations for your heat pump? For example, you might want to have a
heat pump that does not explicitly consume any heat, because they low-temperature heat source is not explicitly modeled.
Currently, the template does not allow for that, because the <code class="docutils literal notranslate"><span class="pre">heat_from</span></code> parameter is mandatory.</p>
<p>Why do we know it is mandatory? Because it is used in the <code class="docutils literal notranslate"><span class="pre">inputs</span></code> section of the <code class="docutils literal notranslate"><span class="pre">Unit</span></code> definition. But that is not
clear, or transparent. Before we continue, we will fill in the mandatory documentation fields for the template. We do
that by adding the following information directly at the beginning of the template file, right before the <code class="docutils literal notranslate"><span class="pre">parameters</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="c1"># # Custom Heat Pump</span>
</span><span id="line-2">
</span><span id="line-3"><span class="c1"># A (custom) heat pump that consumes electricity and heat, and produces heat.</span>
</span><span id="line-4">
</span><span id="line-5"><span class="c1"># ## Parameters</span>
</span><span id="line-6"><span class="c1"># - `p_nom`: The nominal power (electricity) of the heat pump.</span>
</span><span id="line-7"><span class="c1"># - `electricity_from`: The `Node` that this heat pump is connected to for electricity input.</span>
</span><span id="line-8"><span class="c1"># - `heat_from`: The `Node` that this heat pump is connected to for heat input.</span>
</span><span id="line-9"><span class="c1"># - `heat_to`: The `Node` that this heat pump is connected to for heat output.</span>
</span><span id="line-10"><span class="c1"># - `cop`: The coefficient of performance of the heat pump.</span>
</span><span id="line-11">
</span><span id="line-12"><span class="c1"># ## Components</span>
</span><span id="line-13"><span class="c1"># _to be added_</span>
</span><span id="line-14">
</span><span id="line-15"><span class="c1"># ## Usage</span>
</span><span id="line-16"><span class="c1"># _to be added_</span>
</span><span id="line-17">
</span><span id="line-18"><span class="c1"># ## Details</span>
</span><span id="line-19"><span class="c1"># _to be added_</span>
</span><span id="line-20">
</span><span id="line-21"><span class="nt">parameters</span><span class="p">:</span>
</span><span id="line-22"><span class="w">  </span><span class="c1"># ...</span>
</span></code></pre></div>
</div>
<div class="note admonition">
<p class="admonition-title">Docstring format</p>
<p>All of that is actually just Markdown inserted into your template. However, make sure to stick to separating the
leading <code class="docutils literal notranslate"><span class="pre">#</span></code> from the actual text by a space, as this is required for IESopt to better understand your documentation.</p>
</div>
<p>Now, every user of the template will see this information, and they will notice, that none of the parameters are marked
as optional. As you see, there are a lot of other sections to be added, but we will fill them out at the end, after we
have finished the template, see the section on <a class="reference external" href="https://ait-energy.github.io/IESopt.jl/dev/pages/tutorials/templates_1/#Finalizing-the-docstring" rel="nofollow noopener" title="-- IESopt -- 2.6.1"><span class="xref myst">finalizing the docstring</span><svg fill="currentColor" height="1em" stroke="none" viewbox="0 96 960 960" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M188 868q-11-11-11-28t11-28l436-436H400q-17 0-28.5-11.5T360 336q0-17 11.5-28.5T400 296h320q17 0 28.5 11.5T760 336v320q0 17-11.5 28.5T720 696q-17 0-28.5-11.5T680 656V432L244 868q-11 11-28 11t-28-11Z"></path></svg></a>.</p>
<p>Let’s continue with accounting for different configurations. We will cover the following steps:</p>
<ol class="arabic simple">
<li><p>Making the <code class="docutils literal notranslate"><span class="pre">heat_from</span></code> parameter optional</p></li>
<li><p>Extending the template to allow for sizing the heat pump (an investment decision)</p></li>
<li><p>Handling more complex COP configurations</p></li>
</ol>
<section id="optional-parameter-and-sizing-decision">
<h3>Optional parameter and sizing decision<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#optional-parameter-and-sizing-decision" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#optional-parameter-and-sizing-decision'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>While there are multiple ways to make a parameter optional, we will make use of the most powerful one, so that you are
able to apply it for your models as well. For that, we will add “complex” functionalities to the template, which is done
using three different “functions”:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">validate</span></code>: This function is called when the template is parsed, and it is used to check if the parameters are valid.
If they are not, an error is thrown. This helps to inform the user of any misconfiguration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prepare</span></code>: This function is called when the template is instantiated, and it is used to prepare the component for
usage. This can be used to set default values, or to calculate derived parameters (which we will use to tackle the
three additions mentioned above).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">finalize</span></code>: This function is called when the template is finalized, and it enables a wide range of options. We will
use this to allow a smooth result extraction for the heat pump, but you could also use it to add additional (more
complex) constraints to the component, or even modify the model’s objective function.</p></li>
</ol>
<p>Let’s start by adding the <code class="docutils literal notranslate"><span class="pre">functions</span></code> entry (which we suggest doing at the end of the file):</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="c1"># ... the whole docstring ...</span>
</span><span id="line-2">
</span><span id="line-3"><span class="nt">parameters</span><span class="p">:</span>
</span><span id="line-4"><span class="w">  </span><span class="c1"># ...</span>
</span><span id="line-5">
</span><span id="line-6"><span class="nt">component</span><span class="p">:</span>
</span><span id="line-7"><span class="w">  </span><span class="c1"># ...</span>
</span><span id="line-8">
</span><span id="line-9"><span class="nt">functions</span><span class="p">:</span>
</span><span id="line-10"><span class="w">  </span><span class="nt">validate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="line-11"><span class="w">    </span><span class="no"># ... we will put the validation code here ...</span>
</span><span id="line-12"><span class="w">  </span><span class="nt">prepare</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="line-13"><span class="w">    </span><span class="no"># ... we will put the preparation code here ...</span>
</span><span id="line-14"><span class="w">  </span><span class="nt">finalize</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="line-15"><span class="w">    </span><span class="no"># ... we will put the finalization code here ...</span>
</span></code></pre></div>
</div>
<blockquote>
<div><p>The <code class="docutils literal notranslate"><span class="pre">|</span></code> at the end of the line indicates that the following lines are a multiline string. This is a YAML feature that
allows you to write more complex code in a more readable way.</p>
</div></blockquote>
<p>Let’s start by filling out the validation function. Everything you do and write here, is interpreted as Julia code, and
compiled directly into your model. This means that you can use all the power of Julia, but also that you need to be
careful with what you do. You have access to certain helper functions and constants, which we will introduce here. If
you have never written a line of Julia code, don’t worry. We will guide you through this - it’s actually (at least for
the parts that you will need) extremely similar to Python.</p>
<section id="validation">
<h4>Validation<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#validation"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h4>
<p>The validation function is used to check if the parameters are valid. Add the following code to the <code class="docutils literal notranslate"><span class="pre">validate</span></code> section:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nt">functions</span><span class="p">:</span>
</span><span id="line-2"><span class="w">  </span><span class="nt">validate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="line-3"><span class="w">    </span><span class="no"># Check if `p_nom` is non-negative.</span>
</span><span id="line-4"><span class="w">    </span><span class="no">@check this.get("p_nom") isa Number</span>
</span><span id="line-5"><span class="w">    </span><span class="no">@check this.get("p_nom") &gt;= 0</span>
</span><span id="line-6">
</span><span id="line-7"><span class="w">    </span><span class="no"># Check if the `Node` parameters are `String`s, where `heat_from` may also be `nothing`.</span>
</span><span id="line-8"><span class="w">    </span><span class="no">@check this.get("electricity_from") isa String</span>
</span><span id="line-9"><span class="w">    </span><span class="no">@check this.get("heat_from") isa String || isnothing(this.get("heat_from"))</span>
</span><span id="line-10"><span class="w">    </span><span class="no">@check this.get("heat_to") isa String</span>
</span><span id="line-11">
</span><span id="line-12"><span class="w">    </span><span class="no"># Check if `cop` is positive.</span>
</span><span id="line-13"><span class="w">    </span><span class="no">@check this.get("cop") isa Number</span>
</span><span id="line-14"><span class="w">    </span><span class="no">@check this.get("cop") &gt; 0</span>
</span><span id="line-15"><span class="w">  </span><span class="c1"># ... the rest of the template ...</span>
</span></code></pre></div>
</div>
<p>Let’s go through this step by step:</p>
<ul class="simple">
<li><p>You can start comments (as separate line or inline) with <code class="docutils literal notranslate"><span class="pre">#</span></code>, as you would in Python.</p></li>
<li><p>You can use <code class="docutils literal notranslate"><span class="pre">this.get("some_param")</span></code> to access the value of a parameter.</p></li>
<li><p>You can use <code class="docutils literal notranslate"><span class="pre">@check</span></code> to check if a condition is met. If it is not, an error will be thrown. All statements starting
with <code class="docutils literal notranslate"><span class="pre">@</span></code> are so called “macros”, which are just “special” functions. You can do <code class="docutils literal notranslate"><span class="pre">@check(condition)</span></code> or
<code class="docutils literal notranslate"><span class="pre">@check</span> <span class="pre">condition</span></code>, since macros do not require parentheses.</p></li>
<li><p>You can use <code class="docutils literal notranslate"><span class="pre">isa</span></code> to check if a value is of a certain type. This is similar to <code class="docutils literal notranslate"><span class="pre">isinstance</span></code> in Python. While it is a
special keyword, if you prefer, you can also call it in a more conventional way: <code class="docutils literal notranslate"><span class="pre">isa(this.get("p_nom"),</span> <span class="pre">Number)</span></code>.</p></li>
<li><p>Data types are capitalized in Julia, so it is <code class="docutils literal notranslate"><span class="pre">String</span></code> instead of <code class="docutils literal notranslate"><span class="pre">string</span></code>, and <code class="docutils literal notranslate"><span class="pre">Number</span></code> is a superset of all numeric
types (if necessary you could instead, e.g., check for <code class="docutils literal notranslate"><span class="pre">this.get("some_param")</span> <span class="pre">isa</span> <span class="pre">Int</span></code>).</p></li>
<li><p>Logical operators are similar to Python, so <code class="docutils literal notranslate"><span class="pre">||</span></code> is like <code class="docutils literal notranslate"><span class="pre">or</span></code>, and <code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> is like <code class="docutils literal notranslate"><span class="pre">and</span></code>.</p></li>
<li><p>If all checks pass, the template is considered valid, and the model can be built.</p></li>
</ul>
</section>
<section id="preparation">
<h4>Preparation<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#preparation"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h4>
<p>Next, we will add the preparation function. This function is used to prepare the component for usage. Since we would
like to make the <code class="docutils literal notranslate"><span class="pre">heat_from</span></code> parameter optional, and we would like to account for optional sizing, we will first modify
the parameters accordingly:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nt">parameters</span><span class="p">:</span>
</span><span id="line-2"><span class="w">  </span><span class="nt">p_nom</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-3"><span class="w">  </span><span class="nt">p_nom_max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-4"><span class="w">  </span><span class="nt">electricity_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-5"><span class="w">  </span><span class="nt">heat_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-6"><span class="w">  </span><span class="nt">heat_to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-7"><span class="w">  </span><span class="nt">cop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-8"><span class="w">  </span><span class="nt">_inputs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-9"><span class="w">  </span><span class="nt">_conversion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-10"><span class="w">  </span><span class="nt">_capacity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-11"><span class="w">  </span><span class="nt">_invest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span></code></pre></div>
</div>
<p>One step at a time. We added the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p_nom_max</span></code>: The maximum nominal power of the heat pump. This is optional, and if not specified, it will default to
<code class="docutils literal notranslate"><span class="pre">p_nom</span></code>, which will disable the sizing feature.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_inputs</span></code>: This is an internal / private parameter (since it starts with an underscore), which we will user later.
These parameters are not exposed to the user, and can not be set or modified from the outside.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_capacity</span></code>: This is another internal parameter, which we will use to store the capacity of the heat pump (which could
now either bne <code class="docutils literal notranslate"><span class="pre">p_nom</span></code> or whatever the investment decision results in).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_conversion</span></code>: This is another internal parameter, which we will use to store the conversion formula.</p></li>
</ul>
<p>Before we can actually add the code for the <code class="docutils literal notranslate"><span class="pre">prepare</span></code> function, we need to modify our component definition, as well.
We (1) will change from <code class="docutils literal notranslate"><span class="pre">component</span></code> to <code class="docutils literal notranslate"><span class="pre">components</span></code> (since it now contains more than just one), (2) will add a
<code class="docutils literal notranslate"><span class="pre">Decision</span></code> that should handle the sizing / investment, and modify the <code class="docutils literal notranslate"><span class="pre">Unit</span></code> slightly:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nt">components</span><span class="p">:</span>
</span><span id="line-2"><span class="w">  </span><span class="nt">unit</span><span class="p">:</span>
</span><span id="line-3"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Unit</span>
</span><span id="line-4"><span class="w">    </span><span class="nt">inputs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;_inputs&gt;</span>
</span><span id="line-5"><span class="w">    </span><span class="nt">outputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">heat</span><span class="p">:</span><span class="w"> </span><span class="nv">&lt;heat_to&gt;</span><span class="p p-Indicator">}</span>
</span><span id="line-6"><span class="w">    </span><span class="nt">conversion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;_conversion&gt;</span>
</span><span id="line-7"><span class="w">    </span><span class="nt">capacity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;_capacity&gt; in:electricity</span>
</span><span id="line-8"><span class="w">  </span>
</span><span id="line-9"><span class="w">  </span><span class="nt">decision</span><span class="p">:</span>
</span><span id="line-10"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Decision</span>
</span><span id="line-11"><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;_invest&gt;</span>
</span><span id="line-12"><span class="w">    </span><span class="nt">lb</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;p_nom&gt;</span>
</span><span id="line-13"><span class="w">    </span><span class="nt">ub</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;p_nom_max&gt;</span>
</span></code></pre></div>
</div>
<p>So … a lot of changes. Let’s go through them step by step:</p>
<ul class="simple">
<li><p>We changed <code class="docutils literal notranslate"><span class="pre">component</span></code> to <code class="docutils literal notranslate"><span class="pre">components</span></code>, because we now have multiple components.</p></li>
<li><p>We added a <code class="docutils literal notranslate"><span class="pre">unit</span></code> component, which is the actual heat pump. We replaced the fixed values with the internal parameters.</p></li>
<li><p>We added a new component <code class="docutils literal notranslate"><span class="pre">decision</span></code>, which is a <code class="docutils literal notranslate"><span class="pre">Decision</span></code>. This component is used to handle investment
decisions. It is enabled if <code class="docutils literal notranslate"><span class="pre">_invest</span></code> evaluates to <code class="docutils literal notranslate"><span class="pre">true</span></code>. It has a lower bound <code class="docutils literal notranslate"><span class="pre">lb</span></code> and an upper bound <code class="docutils literal notranslate"><span class="pre">ub</span></code>, which
are the minimum and maximum values that the decision can take. In our case, the decision is the nominal power of the
heat pump, which can be between <code class="docutils literal notranslate"><span class="pre">p_nom</span></code> and <code class="docutils literal notranslate"><span class="pre">p_nom_max</span></code>.</p></li>
</ul>
<div class="note admonition">
<p class="admonition-title">Naming the components</p>
<p>The names of the components are arbitrary, and you can choose whatever you like. However, it is recommended to use
meaningful names, so that you can easily understand what the component does. Component names follow a naming
convention similar to <code class="docutils literal notranslate"><span class="pre">snake_case</span></code>: They must start with a lower-case letter, and can contain numbers and
underscores (but are not allowed to end in an <code class="docutils literal notranslate"><span class="pre">_</span></code>). They can further contain <code class="docutils literal notranslate"><span class="pre">.</span></code>, but this is “dangerous” and an
expert feature, that you should not use unless you know what it does, and why you need it.</p>
</div>
<p>Onto the actual functionality. Let’s add the <code class="docutils literal notranslate"><span class="pre">prepare</span></code> function, and some additional validation code:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="nt">functions</span><span class="p">:</span>
</span><span id="line-2"><span class="w">  </span><span class="nt">validate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="line-3"><span class="w">    </span><span class="no"># ... the previous validation code ...</span>
</span><span id="line-4">
</span><span id="line-5"><span class="w">    </span><span class="no"># Check if `p_nom_max` is either `nothing` or at least `p_nom`.</span>
</span><span id="line-6"><span class="w">    </span><span class="no">@check isnothing(this.get("p_nom_max")) || (this.get("p_nom_max") isa Number &amp;&amp; this.get("p_nom_max") &gt;= this.get("p_nom"))</span>
</span><span id="line-7"><span class="w">  </span><span class="nt">prepare</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="line-8"><span class="w">    </span><span class="no"># Determine if investment should be enabled, and set the parameter (used to enable `decision`).</span>
</span><span id="line-9"><span class="w">    </span><span class="no">invest = !isnothing(this.get("p_nom_max")) &amp;&amp; this.get("p_nom_max") &gt; this.get("p_nom")</span>
</span><span id="line-10"><span class="w">    </span><span class="no">this.set("_invest", invest)</span>
</span><span id="line-11">
</span><span id="line-12"><span class="w">    </span><span class="no">if invest</span>
</span><span id="line-13"><span class="w">        </span><span class="no"># Set the capacity to the size of the decision variable.</span>
</span><span id="line-14"><span class="w">        </span><span class="no">myself = this.get("self")</span>
</span><span id="line-15"><span class="w">        </span><span class="no">this.set("_capacity", "$(myself).decision:value")</span>
</span><span id="line-16"><span class="w">    </span><span class="no">else</span>
</span><span id="line-17"><span class="w">        </span><span class="no"># Set the capacity to the value of `p_nom`.</span>
</span><span id="line-18"><span class="w">        </span><span class="no">this.set("_capacity", this.get("p_nom"))</span>
</span><span id="line-19"><span class="w">    </span><span class="no">end</span>
</span><span id="line-20">
</span><span id="line-21"><span class="w">    </span><span class="no"># Prepare some helper variables to make the code afterwards more readable.</span>
</span><span id="line-22"><span class="w">    </span><span class="no">elec_from = this.get("electricity_from")</span>
</span><span id="line-23"><span class="w">    </span><span class="no">heat_from = this.get("heat_from")</span>
</span><span id="line-24"><span class="w">    </span><span class="no">cop = this.get("cop")</span>
</span><span id="line-25">
</span><span id="line-26"><span class="w">    </span><span class="no"># Handle the optional `heat_from` parameter.</span>
</span><span id="line-27"><span class="w">    </span><span class="no">if isnothing(heat_from)</span>
</span><span id="line-28"><span class="w">        </span><span class="no"># If `heat_from` is not specified, we just use electricity as input.</span>
</span><span id="line-29"><span class="w">        </span><span class="no">this.set("_inputs", "{electricity: $(elec_from)}")</span>
</span><span id="line-30"><span class="w">        </span><span class="no">this.set("_conversion", "1 electricity -&gt; $(cop) heat")</span>
</span><span id="line-31"><span class="w">    </span><span class="no">else</span>
</span><span id="line-32"><span class="w">        </span><span class="no"># If `heat_from` is specified, we now have to account for two inputs.</span>
</span><span id="line-33"><span class="w">        </span><span class="no">this.set("_inputs", "{electricity: $(elec_from), heat: $(heat_from)}")</span>
</span><span id="line-34"><span class="w">        </span><span class="no">this.set("_conversion", "1 electricity + $(cop - 1) heat -&gt; $(cop) heat")</span>
</span><span id="line-35"><span class="w">    </span><span class="no">end</span>
</span></code></pre></div>
</div>
<p>Once again, let’s go through this step by step:</p>
<p>To be added.</p>
</section>
</section>
<section id="complex-cop-configurations">
<h3>Complex COP configurations<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#complex-cop-configurations" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#complex-cop-configurations'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>To be added.</p>
</section>
</section>
<section id="the-finalize-function">
<h2>The <code class="docutils literal notranslate"><span class="pre">finalize</span></code> function<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#the-finalize-function" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#the-finalize-function'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>To be added.</p>
</section>
<section id="finalizing-the-docstring">
<h2>Finalizing the docstring<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#finalizing-the-docstring" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#finalizing-the-docstring'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>To be added.</p>
</section>
<section id="conclusion">
<h2>Conclusion<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#conclusion" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#conclusion'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>To be added.</p>
<details class="admonition-complete-template-yaml admonition">
<summary class="admonition-title">Complete template YAML</summary>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="c1"># # Custom Heat Pump</span>
</span><span id="line-2">
</span><span id="line-3"><span class="c1"># A (custom) heat pump that consumes electricity and heat, and produces heat.</span>
</span><span id="line-4">
</span><span id="line-5"><span class="c1"># ## Parameters</span>
</span><span id="line-6"><span class="c1"># - `p_nom`: The nominal power (electricity) of the heat pump.</span>
</span><span id="line-7"><span class="c1"># - `electricity_from`: The `Node` that this heat pump is connected to for electricity input.</span>
</span><span id="line-8"><span class="c1"># - `heat_from`: The `Node` that this heat pump is connected to for heat input.</span>
</span><span id="line-9"><span class="c1"># - `heat_to`: The `Node` that this heat pump is connected to for heat output.</span>
</span><span id="line-10"><span class="c1"># - `cop`: The coefficient of performance of the heat pump.</span>
</span><span id="line-11">
</span><span id="line-12"><span class="c1"># ## Components</span>
</span><span id="line-13"><span class="c1"># _to be added_</span>
</span><span id="line-14">
</span><span id="line-15"><span class="c1"># ## Usage</span>
</span><span id="line-16"><span class="c1"># _to be added_</span>
</span><span id="line-17">
</span><span id="line-18"><span class="c1"># ## Details</span>
</span><span id="line-19"><span class="c1"># _to be added_</span>
</span><span id="line-20">
</span><span id="line-21"><span class="nt">parameters</span><span class="p">:</span>
</span><span id="line-22"><span class="w">  </span><span class="nt">p_nom</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-23"><span class="w">  </span><span class="nt">p_nom_max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-24"><span class="w">  </span><span class="nt">electricity_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-25"><span class="w">  </span><span class="nt">heat_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-26"><span class="w">  </span><span class="nt">heat_to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-27"><span class="w">  </span><span class="nt">cop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-28"><span class="w">  </span><span class="nt">_inputs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-29"><span class="w">  </span><span class="nt">_conversion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-30"><span class="w">  </span><span class="nt">_capacity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-31"><span class="w">  </span><span class="nt">_invest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</span><span id="line-32">
</span><span id="line-33"><span class="nt">components</span><span class="p">:</span>
</span><span id="line-34"><span class="w">  </span><span class="nt">unit</span><span class="p">:</span>
</span><span id="line-35"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Unit</span>
</span><span id="line-36"><span class="w">    </span><span class="nt">inputs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;_inputs&gt;</span>
</span><span id="line-37"><span class="w">    </span><span class="nt">outputs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">heat</span><span class="p">:</span><span class="w"> </span><span class="nv">&lt;heat_to&gt;</span><span class="p p-Indicator">}</span>
</span><span id="line-38"><span class="w">    </span><span class="nt">conversion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;_conversion&gt;</span>
</span><span id="line-39"><span class="w">    </span><span class="nt">capacity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;_capacity&gt; in:electricity</span>
</span><span id="line-40"><span class="w">    </span>
</span><span id="line-41"><span class="w">  </span><span class="nt">decision</span><span class="p">:</span>
</span><span id="line-42"><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Decision</span>
</span><span id="line-43"><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;_invest&gt;</span>
</span><span id="line-44"><span class="w">    </span><span class="nt">lb</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;p_nom&gt;</span>
</span><span id="line-45"><span class="w">    </span><span class="nt">ub</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;p_nom_max&gt;</span>
</span><span id="line-46">
</span><span id="line-47"><span class="nt">functions</span><span class="p">:</span>
</span><span id="line-48"><span class="w">  </span><span class="nt">validate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="line-49"><span class="w">    </span><span class="no"># Check if `p_nom` is non-negative.</span>
</span><span id="line-50"><span class="w">    </span><span class="no">@check this.get("p_nom") isa Number</span>
</span><span id="line-51"><span class="w">    </span><span class="no">@check this.get("p_nom") &gt;= 0</span>
</span><span id="line-52">
</span><span id="line-53"><span class="w">    </span><span class="no"># Check if the `Node` parameters are `String`s, where `heat_from` may also be `nothing`.</span>
</span><span id="line-54"><span class="w">    </span><span class="no">@check this.get("electricity_from") isa String</span>
</span><span id="line-55"><span class="w">    </span><span class="no">@check this.get("heat_from") isa String || isnothing(this.get("heat_from"))</span>
</span><span id="line-56"><span class="w">    </span><span class="no">@check this.get("heat_to") isa String</span>
</span><span id="line-57">
</span><span id="line-58"><span class="w">    </span><span class="no"># Check if `cop` is positive.</span>
</span><span id="line-59"><span class="w">    </span><span class="no">@check this.get("cop") isa Number</span>
</span><span id="line-60"><span class="w">    </span><span class="no">@check this.get("cop") &gt; 0</span>
</span><span id="line-61">
</span><span id="line-62"><span class="w">    </span><span class="no"># Check if `p_nom_max` is either `nothing` or at least `p_nom`.</span>
</span><span id="line-63"><span class="w">    </span><span class="no">@check isnothing(this.get("p_nom_max")) || (this.get("p_nom_max") isa Number &amp;&amp; this.get("p_nom_max") &gt;= this.get("p_nom"))</span>
</span><span id="line-64"><span class="w">  </span><span class="nt">prepare</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="line-65"><span class="w">    </span><span class="no"># Determine if investment should be enabled, and set the parameter (used to enable `decision`).</span>
</span><span id="line-66"><span class="w">    </span><span class="no">invest = !isnothing(this.get("p_nom_max")) &amp;&amp; this.get("p_nom_max") &gt; this.get("p_nom")</span>
</span><span id="line-67"><span class="w">    </span><span class="no">this.set("_invest", invest)</span>
</span><span id="line-68">
</span><span id="line-69"><span class="w">    </span><span class="no">if invest</span>
</span><span id="line-70"><span class="w">        </span><span class="no"># Set the capacity to the size of the decision variable.</span>
</span><span id="line-71"><span class="w">        </span><span class="no">myself = this.get("self")</span>
</span><span id="line-72"><span class="w">        </span><span class="no">this.set("_capacity", "$(myself).decision:value")</span>
</span><span id="line-73"><span class="w">    </span><span class="no">else</span>
</span><span id="line-74"><span class="w">        </span><span class="no"># Set the capacity to the value of `p_nom`.</span>
</span><span id="line-75"><span class="w">        </span><span class="no">this.set("_capacity", this.get("p_nom"))</span>
</span><span id="line-76"><span class="w">    </span><span class="no">end</span>
</span><span id="line-77">
</span><span id="line-78"><span class="w">    </span><span class="no"># Prepare some helper variables to make the code afterwards more readable.</span>
</span><span id="line-79"><span class="w">    </span><span class="no">elec_from = this.get("electricity_from")</span>
</span><span id="line-80"><span class="w">    </span><span class="no">heat_from = this.get("heat_from")</span>
</span><span id="line-81"><span class="w">    </span><span class="no">cop = this.get("cop")</span>
</span><span id="line-82">
</span><span id="line-83"><span class="w">    </span><span class="no"># Handle the optional `heat_from` parameter.</span>
</span><span id="line-84"><span class="w">    </span><span class="no">if isnothing(heat_from)</span>
</span><span id="line-85"><span class="w">        </span><span class="no"># If `heat_from` is not specified, we just use electricity as input.</span>
</span><span id="line-86"><span class="w">        </span><span class="no">this.set("_inputs", "{electricity: $(elec_from)}")</span>
</span><span id="line-87"><span class="w">        </span><span class="no">this.set("_conversion", "1 electricity -&gt; $(cop) heat")</span>
</span><span id="line-88"><span class="w">    </span><span class="no">else</span>
</span><span id="line-89"><span class="w">        </span><span class="no"># If `heat_from` is specified, we now have to account for two inputs.</span>
</span><span id="line-90"><span class="w">        </span><span class="no">this.set("_inputs", "{electricity: $(elec_from), heat: $(heat_from)}")</span>
</span><span id="line-91"><span class="w">        </span><span class="no">this.set("_conversion", "1 electricity + $(cop - 1) heat -&gt; $(cop) heat")</span>
</span><span id="line-92"><span class="w">    </span><span class="no">end</span>
</span></code></pre></div>
</div>
</details>
</section>
<section id="next-steps">
<h2>Next steps<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#next-steps" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#next-steps'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>While the above template is already quite powerful, it can become hard to maintain and understand if it grows too large.
In the next tutorial, we will cover how to separate the <code class="docutils literal notranslate"><span class="pre">functions</span></code> part of the template into a separate file, and later
will see how this approach can then be extended even further (a concept that we call <code class="docutils literal notranslate"><span class="pre">Addon</span></code>s), which allows
intercepting steps of the model build process.</p>
<p>But … before we go there, let’s start “small”. Check out the section <a class="reference internal" href="templates_2.html"><span class="std std-doc">Templates: Part II</span></a>, where we walk
through the process of “out-sourcing” the <code class="docutils literal notranslate"><span class="pre">functions</span></code> part of the template.</p>
</section>
</section>
</div></div><aside class="hidden text-sm xl:block" id="right-sidebar">
<div class="sticky top-16 -mt-10 max-h-[calc(100vh-5rem)] h-full overflow-y-auto pt-6 space-y-2"><p class="font-medium">On this page</p>
<ul>
<li><a :data-current="activeSection === '#the-basic-structure'" class="reference internal" href="#the-basic-structure">The basic structure</a></li>
<li><a :data-current="activeSection === '#accounting-for-different-configurations'" class="reference internal" href="#accounting-for-different-configurations">Accounting for different configurations</a><ul>
<li><a :data-current="activeSection === '#optional-parameter-and-sizing-decision'" class="reference internal" href="#optional-parameter-and-sizing-decision">Optional parameter and sizing decision</a><ul>
<li><a :data-current="activeSection === '#validation'" class="reference internal" href="#validation">Validation</a></li>
<li><a :data-current="activeSection === '#preparation'" class="reference internal" href="#preparation">Preparation</a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#complex-cop-configurations'" class="reference internal" href="#complex-cop-configurations">Complex COP configurations</a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#the-finalize-function'" class="reference internal" href="#the-finalize-function">The <code class="docutils literal notranslate"><span class="pre">finalize</span></code> function</a></li>
<li><a :data-current="activeSection === '#finalizing-the-docstring'" class="reference internal" href="#finalizing-the-docstring">Finalizing the docstring</a></li>
<li><a :data-current="activeSection === '#conclusion'" class="reference internal" href="#conclusion">Conclusion</a></li>
<li><a :data-current="activeSection === '#next-steps'" class="reference internal" href="#next-steps">Next steps</a></li>
</ul>
</div>
</aside>
</main>
</div>
</div><footer class="py-6 border-t border-border md:py-0">
<div class="container flex flex-col items-center justify-between gap-4 md:h-24 md:flex-row">
<div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0">
<p class="text-sm leading-loose text-center text-muted-foreground md:text-left">© AIT Austrian Institute of Technology GmbH Built with <a class="font-medium underline underline-offset-4" href="https://www.sphinx-doc.org" rel="noreferrer">Sphinx 9.1.0</a></p>
</div>
</div>
</footer>
</div><button :class="{'opacity-0 invisible' : !showScrollTop}" @click="window.scrollTo({top: 0, behavior: 'smooth'})" class="fixed bottom-8 right-8 p-2 z-10 rounded-sm bg-gray-700 text-xs text-white transition-all duration-1000 hover:bg-gray-950 focus:bg-gray-950" id="scrolltop" x-cloak="">
<svg aria-hidden="true" class="inline fill-current mb-[2px]" height="14" viewbox="0 96 960 960" width="14" xmlns="http://www.w3.org/2000/svg">
<path d="M450 896V370L202 618l-42-42 320-320 320 320-42 42-248-248v526h-60Z"></path>
</svg>
  Back to top
</button>
<script src="../../_static/documentation_options.js?v=f5da64ed"></script>
<script src="../../_static/doctools.js?v=fd6eb6e6"></script>
<script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="../../_static/togglebutton.js?v=1ae7504c"></script>
<script defer="defer" src="../../_static/theme.js?v=582b20c5"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
</body>
</html>